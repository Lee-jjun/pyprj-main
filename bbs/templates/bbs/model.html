{% extends 'base.html' %}
{% load static %}

{% block content %}
  <h2>모델 개발 과정</h2>

  <!-- 셀 1: 모델 불러오기 & 학습 -->
  <div class="cell">
    <div class="input">
      <span class="prompt">In [1]:</span>
      <code>
from sklearn.ensemble import RandomForestRegressor<br>
model = RandomForestRegressor(n_estimators=100, random_state=42)<br>
model.fit(X_train, y_train)
      </code>
    </div>
    <button onclick="toggleOutput('out1')">▶ 실행</button>
    <div class="output" id="out1">
      <pre>
✅ 모델 학습 완료
      </pre>
    </div>
  </div>

  <!-- 셀 2: 예측 -->
  <div class="cell">
    <div class="input">
      <span class="prompt">In [2]:</span>
      <code>y_pred = model.predict(X_test)<br>y_pred[:5]</code>
    </div>
    <button onclick="toggleOutput('out2')">▶ 실행</button>
    <div class="output" id="out2">
      <pre>
array([234.56, 198.23, 312.78, 276.45, 221.90])
      </pre>
    </div>
  </div>

  <!-- 셀 3: 성능 확인 -->
  <div class="cell">
    <div class="input">
      <span class="prompt">In [3]:</span>
      <code>
from sklearn.metrics import mean_squared_error, r2_score<br>
rmse = mean_squared_error(y_test, y_pred, squared=False)<br>
r2 = r2_score(y_test, y_pred)<br>
print("RMSE:", rmse)<br>
print("R²:", r2)
      </code>
    </div>
    <button onclick="toggleOutput('out3')">▶ 실행</button>
    <div class="output" id="out3">
      <pre>
RMSE: 45.67
R²: 0.87
      </pre>
    </div>
  </div>

  <!-- 셀 4: 피처 중요도 (옵션: 이미지) -->
  <div class="cell">
    <div class="input">
      <span class="prompt">In [4]:</span>
      <code>
import matplotlib.pyplot as plt<br>
importances = model.feature_importances_<br>
plt.bar(range(len(importances)), importances)<br>
plt.show()
      </code>
    </div>
    <button onclick="toggleOutput('out4')">▶ 실행</button>
    <div class="output" id="out4">
      <img src="{% static 'img/feature_importance.png' %}" alt="특성 중요도 그래프" width="500">
    </div>
  </div>

{% endblock %}
